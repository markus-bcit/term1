: CHAPTER 11 - Database Performance Tuning and Query Optimization

: This file contains solutions to problems in Chapter 11
: Theachers and students can use this file to "copy and paste"
: the SQL commands from this file to the "SQL>" command prompt (Oracle SQL Plus).
: Please be aware that date formats may differ among DBMS programs.
: Most commands here are for ORACLE or MS ACCESS where indicated.
 

:=================:
:Problem Solutions:
:=================:


:== P2
CREATE INDEX EMP_NDX1 ON EMPLOYEE(EMP_AREACODE);
CREATE INDEX EMP_NDX2 ON EMPLOYEE(EMP_LNAME, EMP_FNAME);

:== P14
ANALYZE TABLE LINE COMPUTE STATISTICS

:== P17
CREATE INDEX VEND_NDX1 ON VENDOR(V_STATE);
CREATE INDEX VEND_NDX2 ON VENDOR(V_NAME);

:== P21
SELECT /*+ FIRST_ROWS */ * FROM PRODUCT WHERE P_QOH <= P_MIN;

:== P23
CREATE INDEX VEND_NDX1 ON VENDOR(V_STATE);
CREATE INDEX VEND_NDX2 ON VENDOR(V_AREACODE);

:== P24
ANALYZE TABLE PRODUCT COMPUTE STATISTICS;
ANALYZE TABLE VENDOR COMPUTER STATISTICS;

:== P26
SELECT	/*+ INDEX(PROD_NDX1) */ P_CODE, P_DESCRIPT, P_QOH, P_PRICE, V_CODE 
FROM	PRODUCT
WHERE	V_CODE = '1344'
ORDER BY	P_CODE;

:== P27
SELECT	P_CODE, P_DESCRIPT, P_QOH, P_PRICE, V_CODE
FROM	PRODUCT
WHERE	P_REORDER = 50
	AND	P_MIN = 50
	AND	P_QOH < 50
ORDER BY	P_QOH;

:== P28
CREATE INDEX PROD_NDX1 ON PRODUCT(P_REORDER);
CREATE INDEX PROD_NDX2 ON PRODUCT(P_MIN);
CREATE INDEX PROD_NDX3 ON PRODUCT(P_QOH);


:== P30
SELECT	 CUS_CODE, MAX(LINE_TOTAL)
FROM	 CUSTOMER NATURAL JOIN INVOICE NATURAL JOIN LINE
WHERE	 CUS_AREACODE = '615'
GROUP BY CUS_CODE;

:== P31
CREATE INDEX CUS_NDX1 ON CUSTOMER(CUS_AREACODE);

:== P32
SELECT	 /*+ INDEX(CUS_NDX1) */ CUS_CODE, MAX(LINE_TOTAL)
FROM	 CUSTOMER NATURAL JOIN INVOICE NATURAL JOIN LINE
WHERE	 CUS_AREACODE = '615'
GROUP BY CUS_CODE;
