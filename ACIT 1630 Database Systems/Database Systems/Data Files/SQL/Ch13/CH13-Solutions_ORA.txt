/* DATABASE SYSTEMS, CORONEL/MORRIS */
/* TYPE OF SQL : ORACLE */

--5
SELECT CUS_CODE, P_CODE, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT
GROUP BY ROLLUP(CUS_CODE, P_CODE);

--6
SELECT CUS_CODE, TM_MONTH, P_CODE, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWTIME USING (TM_ID)
GROUP BY ROLLUP (CUS_CODE, TM_MONTH, P_CODE);

--7
SELECT REG_ID, CUS_CODE, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWCUSTOMER USING (CUS_CODE)
GROUP BY ROLLUP (REG_ID, CUS_CODE);

--8
SELECT TM_MONTH, P_CATEGORY, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWPRODUCT USING (P_CODE) JOIN DWTIME USING (TM_ID)
GROUP BY ROLLUP (TM_MONTH, P_CATEGORY);

--9
SELECT TM_MONTH, COUNT(*) AS NUMPROD, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWTIME USING (TM_ID)
GROUP BY ROLLUP (TM_MONTH);

--10
SELECT TM_MONTH, P_CATEGORY, COUNT(*) AS NUMPROD, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWTIME USING (TM_ID) JOIN DWPRODUCT USING (P_CODE)
GROUP BY ROLLUP (TM_MONTH, P_CATEGORY); 

--11
SELECT TM_MONTH, P_CATEGORY, P_CODE, COUNT(*) AS NUMPROD, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWTIME USING (TM_ID) JOIN DWPRODUCT USING (P_CODE)
GROUP BY ROLLUP (TM_MONTH, P_CATEGORY, P_CODE); 

--12
SELECT TM_MONTH, P_CATEGORY, COUNT(*) AS NUMPROD, SUM(SALE_UNITS * SALE_PRICE) AS TOTSALES
FROM DWDAYSALESFACT JOIN DWTIME USING (TM_ID) JOIN DWPRODUCT USING (P_CODE)
GROUP BY CUBE (TM_MONTH, P_CATEGORY); 


